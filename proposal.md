# RNAseq Data Analysis Pipeline for the publicly available dataset 
## 1. Introduction
Androgen-deprivation therapy (ADT) is standard treatment for locally advanced or metastatic prostate cancer (PCa). After approximately 2–3 years, patients can develop castration-resistant PCa (CRPC), for which the prognosis is poor despite newer second-line cytotoxic chemotherapy and endocrine therapies. The molecular mechanisms underlying CRPC progression are unclear. Therefore, the objective of original study was to undertake quantitative tumour transcriptome profiling prior to and following ADT to identify functionally important androgen-regulated pathways or genes that may be reactivated in CRPC.

## 2. Original study design
Tumour-rich, targeted prostatic biopsies were taken from seven patients with locally advanced or metastatic PCa before and approximately 22 wk after ADT initiation. Illumina RNA-seq was performed, and complementary DNA sample library normalization was conducted using the Illumina duplex-specific nuclease protocol. The resulting data were sequenced using the HiSeq 2000 sequencer in a paired-end sequencing strategy. The published paper detailing this study can be accessed [here](https://www.sciencedirect.com/science/article/pii/S0302283813008324#sec0010).

## 3. Dataset
The [dataset](https://www.ncbi.nlm.nih.gov/bioproject/?term=prjna209978) comprises 14 biosamples from 7 patients, both pre and post ADT treatment. Utilizing the NCBI SRA toolkit, all 14 biosamples will be imported and downloaded into the working directory with the prefetch and fastq-dump command, each identified by its unique SRR ID. With this dataset, I will approach differently from the original research. For simplicity and ease of analysis, I will focus on one biosample with paired-end reads, regardless of pre or post-ADT treatment. Moreover, I will import the human reference genome to my working directory so that each read in FASTQ file will be “mapped” to a reference genome.

## 4. Data Analysis
The standard RNA-seq data analysis pipeline will be followed. I will process the RNA-seq data to generate counts using featureCounts. All the necessary packages will be loaded within the OSC using the module command and its sub-commands. If the required software is not installed at OSC or that I need a more recent version of the software, I will load them from conda. The analysis will encompass sequence quality control using FastQC to assess the quality of raw sequencing data, followed by alignment with HISAT2/STAR tool which produces aligned BAM files including the Genome BAM and Transcriptome BAM. Post-alignment, Picard MarkDuplicates will process the Genome BAM file to identify and handle duplicate reads. SAMtools index will then be employed to generate an index for the BAM file, facilitating efficient downstream processing. The indexed BAM file will be processed further with RNA-SeQC which takes the BAM file, human genome reference sequence and Gene Transfer Format (GTF) file as inputs to generate transcriptome-level expression quantifications and standard quality control metrics. The sbatch command will be employed to submit each analysis step as a job to the cluster environment. Finally, output files including quality control reports, alignment statistics, and expression quantification results will be collected and organized for further downstream analysis, maintaining a structured directory layout with separate folders for raw data, intermediate files, and final results.

## 5. Limitations
One aspect that I am uncertain or not confident is looping over the files/samples inside the scripts that processes all files/samples in a single run. Consequently, the decision to analyze only one biosample was made, although the original intention was to analyze all 14 biosamples. Given limited expertise in bioinformatics and RNA-seq data analysis, potential issues may arise during the project. As I delve into this dataset, I anticipate uncovering and addressing technical intricacies associated with RNA-seq data analysis. Furthermore, I may need to adjust or modify some of the aforementioned commands/steps to suit the requirements of this project.

## 6. Motivation for choosing this dataset
This project holds particular relevance as I plan to conduct Illumina sequencing for my ongoing research on porcine sapovirus. Utilizing samples collected from various pigs, the aim is to perform whole-genome analysis using NGS platforms. Similar to the RNA-seq data analysis pipeline described here, mapping short reads from Illumina sequencing to a reference genome will be crucial for assembling these reads into complete or near-complete genomes. Therefore, this project serves as valuable practice for developing proficiency in RNA-seq data analysis, which directly contributes to my research objectives.




